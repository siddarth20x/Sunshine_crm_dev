<div class="container-fluid container-fluid-sm container-fluid-md container-fluid-lg container-fluid-xl">
  <br /><br />
  <button mat-button color="primary" routerLink="/account-management" class="back_btn">
    <span class="material-symbols-outlined"> chevron_left </span> Back
  </button>
  <!-- <mat-form-field appearance="outline">
    <mat-label>Bank</mat-label>
    <mat-select name="bank" (selectionChange)="companySelectHandler($event)">
      <mat-option disabled> --Select-- </mat-option>
      <mat-option
        *ngFor="let company of companyArr"
        [value]="company.company_name"
      >
        {{ company.company_name }}
      </mat-option>
    </mat-select>
    <mat-error>Please select bank to continue</mat-error>
  </mat-form-field> -->
  <br />
  <br />
  <mat-accordion class="accordion">
    <mat-expansion-panel [expanded]="step === 1">
      <mat-expansion-panel-header>
        <mat-panel-title class="panelTitle">
          <span>Advanced Search</span>
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="panelContent" [formGroup]="advSearchForm">
        <mat-form-field appearance="outline">
          <mat-label>Bank</mat-label>
          <mat-select name="bank" (selectionChange)="companySelectHandler($event)" formControlName="company_name">
            <mat-option disabled> --Select-- </mat-option>
            <mat-option *ngFor="let company of companyArr" [value]="company.company_name">
              {{ company.company_name }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="advSearchForm.get('company_name')?.hasError('required')">Please select bank to
            continue</mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>From Date((Date uploaded))</mat-label>
          <input type="date" matInput formControlName="in_start_dtm" />
          <mat-error *ngIf="advSearchForm.get('from_date')?.hasError('required')">
            From date is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>To Date((Date uploaded)</mat-label>
          <input type="date" matInput formControlName="in_end_dtm" />
          <mat-error *ngIf="advSearchForm.get('to_date')?.hasError('required')">
            To date is required
          </mat-error>
        </mat-form-field>
      </div>
      <div>
        <button mat-raised-button class="advSerachBtn" color="primary" (click)="advanceSerachFilters()"
          [disabled]="advSearchForm.invalid">
          Search
        </button>
        <!-- <button
          mat-stroked-button
          class="advSerachBtn"
          color=""
          (click)="advanceSerachClearFilters()"
        >
          Clear Filters
        </button> -->
      </div>
    </mat-expansion-panel>
  </mat-accordion>
  <div class="row table__row">
    <mat-card class="table__card">
      <mat-progress-bar mode="indeterminate" *ngIf="showProgressBar"></mat-progress-bar>
      <mat-card-header class="table__header">
        <mat-card-title>{{ tableTxt }}</mat-card-title>

        <mat-form-field appearance="standard">
          <mat-label>Type here to filter</mat-label>
          <input matInput (keyup)="applyFilter($event)" #input />
        </mat-form-field>
      </mat-card-header>
      <div class="mat-elevation-z8">
        <table mat-table [dataSource]="dataSource" matSort>
          <ng-container matColumnDef="last_worked_date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Date Uploaded
            </th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Last Worked Date">
              {{ row.modified_dtm | date : "dd-MMM-yyyy" }}
            </td>
          </ng-container>
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let row" #tooltip="matTooltip" matTooltip="{{ row.lead_status_type_name }}"
              matTooltipPosition="left" data-label="Status">
              <span class="material-symbols-outlined" [ngClass]="{
                  'status-pink': row.lead_status_type_name === 'PENDING',
                  'status-yellow': row.lead_status_type_name === 'IN PROGRESS',
                  'status-green': row.lead_status_type_name === 'COMPLETED',
                  'status-blue': row.lead_status_type_name === 'DEFERRED',
                  'status-red': row.lead_status_type_name === 'CANCELLED'
                }">
                radio_button_checked
              </span>
            </td>
          </ng-container>

          <ng-container matColumnDef="customer_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Customer</th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Customer">
              {{ row.customer_name }}
            </td>
          </ng-container>

          <ng-container matColumnDef="product_account_number">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Product Account No.
            </th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Product Account No">
              {{ row.product_account_number }}
            </td>
          </ng-container>

          <ng-container matColumnDef="product_type">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Product Type
            </th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Product Type">
              {{ row.product_type }}
            </td>
          </ng-container>

          <ng-container matColumnDef="pli_status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>PLI</th>
            <td mat-cell *matCellDef="let row" data-label="PLI">
              <ng-container *ngIf="row.has_police_case == 1">
                <span class="material-symbols-outlined status-red-blink">
                  report
                </span>
              </ng-container>
            </td>
          </ng-container>

          <ng-container *ngIf="loggedInUserRole !== 'AGENT'" matColumnDef="multiple_bank_list">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Multiple Banks
            </th>
            <td mat-cell *matCellDef="let row" data-label="Multiple Banks">
              <ng-container *ngIf="row.multiple_banks_list">
                <span class="material-symbols-outlined status-warn-blink">
                  warning
                </span>
              </ng-container>
            </td>
          </ng-container>

          <ng-container matColumnDef="senior_manager">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Senior Manager
            </th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Senior Manager">
              {{ row.senior_manager_id }}
            </td>
          </ng-container>

          <ng-container matColumnDef="team_manager">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Team Manager
            </th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Team Manager">
              {{ row.team_manager_id }}
            </td>
          </ng-container>

          <ng-container matColumnDef="team_lead">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Team Lead</th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Team Lead">
              {{ row.team_lead_id }}
            </td>
          </ng-container>

          <ng-container matColumnDef="agent">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Agent</th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Agent">
              {{ row.assigned_to }}
            </td>
          </ng-container>

          <ng-container matColumnDef="reason">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Reason for Failure</th>
            <td mat-cell *matCellDef="let row" routerLink="/account-management/view/{{ row.lead_id }}/{{
                row.company_id
              }}" data-label="Reason for Failure">
              {{ row.reason }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedAccHoldersColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedAccHoldersColumns"></tr>

          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="10">No account(s) found</td>
          </tr>
        </table>
      </div>
      <mat-paginator [length]="resultsLength" [pageSize]="10" aria-label="Select page of users"
        showFirstLastButtons></mat-paginator>
    </mat-card>
  </div>
</div>